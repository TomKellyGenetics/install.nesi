args = commandArgs(trailingOnly=TRUE)

"required_bioconductor"<-
function(dependency)
{

	nz_repo <- 'http://cran.stat.auckland.ac.nz'
	userdir <- unlist(strsplit(Sys.getenv("R_LIBS_USER"),.Platform$path.sep))[1L]

	if (!file.exists(userdir)) {
	  if (!dir.create(userdir, recursive = TRUE)) {
	     stop("Unable to create ", sQuote(userdir))
	       }
	 }

    # install package
    if(dependency %in% rownames(installed.packages()) == FALSE) {
               source("https://bioconductor.org/biocLite.R")
               biocLite(dependency,lib=userdir, siteRepos=nz_repo, dependencies = TRUE)
               library(dependency, lib.loc=userdir, character.only = TRUE)
        } else {
               print(paste("Package already installed: ", dependency))
        }

}

for(pkg in args){
    required_bioconductor(as.character(pkg))
}
